<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>xFSTK-Stitcher: Operating System Stitching Details</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  <td id="projectlogo"><img alt="Logo" src="stitcher.png"/></td>
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">xFSTK-Stitcher
   &#160;<span id="projectnumber">1.2.0</span>
   </div>
   <div id="projectbrief">Intel SoC Cross Platform Firmware &amp; Software Tool Kit</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">Operating System Stitching Details </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2><a class="anchor" id="os_stitch_sec"></a>
OS Stitching Configuration Setup</h2>
<p>To stitch an OS image the configuration text file needs to be modified. The 'ImageType' for firmware need to be masked and the type 'OSUSB' is used in place. It is recommended to rename the output file. The following is an example:</p>
<p>'ImageType = FWUSB 'ImageName = ./IFWI_output.bin ImageType = OSUSB ImageName = ./OS_image_output.bin</p>
<p>To stitch an OS image the XML file also needs to be modified. The XML file includes important information like the boot image size, destination pointer in RAM, hand-off pointer, partition type, etc. The portion of the XML file related to OS stitching is the following:</p>
<div class="fragment"><pre class="fragment">
    &lt;os_image&gt;
    &lt;!-- OS Image 0 --&gt;
        &lt;minor_revision&gt;0&lt;/minor_revision&gt;
        &lt;major_revision&gt;0&lt;/major_revision&gt;
        &lt;destination_pointer&gt;17825792&lt;/destination_pointer&gt;
        &lt;handoff_pointer&gt;17829888&lt;/handoff_pointer&gt;
        &lt;intel_reserved&gt;0&lt;/intel_reserved&gt;
        &lt;image_attributes&gt;1&lt;/image_attributes&gt;
        &lt;image_filepath&gt;./kboot.unsigned&lt;/image_filepath&gt;
        &lt;is_image_signed&gt;0&lt;/is_image_signed&gt;
        &lt;starting_LBA_in_512_byte_blocks&gt;0&lt;/starting_LBA_in_512_byte_blocks&gt;
        &lt;is_partition&gt;0&lt;/is_partition&gt;
        &lt;partition_status&gt;0&lt;/partition_status&gt;
        &lt;partition_type&gt;0&lt;/partition_type&gt;
    &lt;!-- End OS Image 0 --&gt;
    &lt;/os_image&gt;
    &lt;os_image&gt;
    &lt;!-- OS Image 1 --&gt;
        &lt;minor_revision&gt;0&lt;/minor_revision&gt;
        ...
        &lt;partition_type&gt;0&lt;/partition_type&gt;
    &lt;!-- End OS Image 1 --&gt;
    &lt;/os_image&gt;
    &lt;os_image&gt;
    &lt;!-- OS Image 2 --&gt;
        &lt;minor_revision&gt;0&lt;/minor_revision&gt;
        ...
        &lt;partition_type&gt;0&lt;/partition_type&gt;
    &lt;!-- End OS Image 2 --&gt;
    &lt;/os_image&gt;
    ...
    &lt;!-- Up to 15 OS Images supported --&gt;
    &lt;os_image&gt;
    &lt;!-- OS Image 15 --&gt;
    ...
    &lt;!-- End OS Image 15 --&gt;
    &lt;/os_image&gt;
    </pre></div><p>The following values must be set properly:</p>
<ol type="1">
<li>destination_pointer: 17825792 (value must be in decimal)</li>
<li>handoff_pointer: 17829888 (value must be in decimal)</li>
<li>image_filepath is the file that needs to be stitched</li>
<li>image_attribute<ol type="a">
<li>0x00 Signed OS Kernel Image</li>
<li>0x01 Unsigned OS Kernel Image</li>
<li>0x02 Signed Root File System Image</li>
<li>0x03 Unsigned Root File System Image</li>
<li>0x04 Signed Splash Screen Bitmap Image</li>
<li>0x05 Unsigned Splash Screen Bitmap Image</li>
<li>0x06 Signed "Compromised or Unsigned Kernel" Bitmap Image</li>
<li>0x07 Unsigned "Compromised or Unsigned Kernel" Bitmap Image</li>
<li>0x08 Signed 2nd Stage IAFW</li>
<li>0x09 Unsigned 2nd Stage IAFW</li>
<li>0x0A Signed COS_Kernel</li>
<li>0x0B Unsigned COS Kernel</li>
<li>0x0C Signed FOTA Kernel (aka Android Recovery)</li>
<li>0x0D Unsigned FOTA Kernel (aka Andriod Recovery)</li>
<li>0x0E Signed POS Kernel (aka Android FASTBOOT)</li>
<li>0x0F Unsigned POS Kernel (aka Android FASTBOOT)</li>
<li>0x10 Signed POS COS Kernel</li>
<li>0x11 Unsigned POS COS Kernel</li>
</ol>
</li>
</ol>
<ol type="1">
<li>is_image_signed = 0 Indicates Image will NOT be signed by xFSTK (always set to 0)</li>
<li>starting_LBA_in_512_byte_blocks<ol type="a">
<li>0 indicates a contiguous LBA calculation (OSImage0 LBA = 1, OSImage1 LBA = Size of OSImage0 + 1, ...)</li>
<li>Non-Zero values indicate user specified LBA</li>
</ol>
</li>
<li>is_partition determines if partition_status and partition_type fields are being used<ol type="a">
<li>1 True</li>
<li>0 False</li>
<li>partition_status<ol type="i">
<li>0x80 Bootable(Active)</li>
<li>0x00 non-bootable</li>
</ol>
</li>
<li>partition_type<ol type="i">
<li>0x82 Linux Swap</li>
<li>0x83 Linux Filesystem</li>
</ol>
</li>
</ol>
</li>
<li>For multiple OS stitching add up to 15 OS Image entries in the XML file using OS Image entry 0 as the example Note: Destination and handoff pointer are stored in decimal format and do not change. These values are always stored as decimal in the xml for windows or linux. </li>
</ol>
</div></div><!-- contents -->
<DIV ID="footer">
        <p align="center">
           &copy Intel Corporation 2012
        </p>
</DIV>        


<hr class="footer"/><address class="footer"><small>
Generated on Mon Jan 7 2013 13:22:50 for xFSTK-Stitcher by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
